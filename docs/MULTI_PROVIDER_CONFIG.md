# å¤šæœç´¢å¼•æ“é…ç½®æŒ‡å—

WebChaser æ”¯æŒåŒæ—¶ä½¿ç”¨å¤šä¸ªæœç´¢å¼•æ“ï¼Œåˆå¹¶æœç´¢ç»“æœä»¥è·å¾—æ›´å…¨é¢çš„ä¿¡æ¯è¦†ç›–ã€‚

## é…ç½®æ–¹æ³•

### æ–¹å¼ 1ï¼šå•ä¸€æœç´¢å¼•æ“ï¼ˆé»˜è®¤ï¼‰

åœ¨ `config/config.yaml` ä¸­ï¼š

```yaml
ir_rag:
  search:
    provider: serpapi  # åªä½¿ç”¨ä¸€ä¸ªæœç´¢å¼•æ“
```

å¯é€‰å€¼ï¼š
- `serpapi` - SerpAPI
- `google_custom_search` - Google Custom Search API
- `gcp_vertex_search` - GCP Vertex AI Search

### æ–¹å¼ 2ï¼šå¤šä¸ªæœç´¢å¼•æ“åŒæ—¶ä½¿ç”¨ âœ¨

ä½¿ç”¨**é€—å·åˆ†éš”**å¤šä¸ªæœç´¢å¼•æ“ï¼š

```yaml
ir_rag:
  search:
    provider: serpapi,gcp_vertex_search  # åŒæ—¶ä½¿ç”¨ä¸¤ä¸ª
```

æˆ–ä½¿ç”¨å…¨éƒ¨ä¸‰ä¸ªï¼š

```yaml
ir_rag:
  search:
    provider: serpapi,google_custom_search,gcp_vertex_search
```

## å·¥ä½œåŸç†

### å•ä¸€æœç´¢å¼•æ“æ¨¡å¼

```
æŸ¥è¯¢ â†’ ç”Ÿæˆ5ä¸ªæœç´¢è¯ â†’ å•ä¸€å¼•æ“æœç´¢ â†’ åˆå¹¶å»é‡ â†’ è¿”å›ç»“æœ
```

ç¤ºä¾‹ï¼š
```
[SerpAPI] 5ä¸ªæŸ¥è¯¢ Ã— 20ä¸ªç»“æœ = 100ä¸ªç»“æœ â†’ å»é‡å 74ä¸ªå”¯ä¸€ç»“æœ
```

### å¤šæœç´¢å¼•æ“æ¨¡å¼

```
æŸ¥è¯¢ â†’ ç”Ÿæˆ5ä¸ªæœç´¢è¯ â†’ å¤šä¸ªå¼•æ“å¹¶è¡Œæœç´¢ â†’ åˆå¹¶æ‰€æœ‰ç»“æœ â†’ URLå»é‡ â†’ è¿”å›ç»“æœ
```

ç¤ºä¾‹ï¼š
```
Provider 1 (SerpAPI):        5æŸ¥è¯¢ Ã— 20ç»“æœ = 100ä¸ªç»“æœ
Provider 2 (GCP Vertex):     5æŸ¥è¯¢ Ã— 20ç»“æœ = 100ä¸ªç»“æœ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ€»è®¡:                                   200ä¸ªç»“æœ
å»é‡å:                                 150ä¸ªå”¯ä¸€ç»“æœ  (æ›´å…¨é¢ï¼)
```

## ä¼˜åŠ¿

### 1. **æ›´å…¨é¢çš„æœç´¢è¦†ç›–**
ä¸åŒæœç´¢å¼•æ“ç´¢å¼•çš„å†…å®¹æœ‰æ‰€ä¸åŒï¼Œç»„åˆä½¿ç”¨å¯ä»¥è·å¾—æ›´å…¨é¢çš„ç»“æœã€‚

### 2. **è‡ªåŠ¨æ•…éšœè½¬ç§»**
å¦‚æœæŸä¸ªæœç´¢å¼•æ“å¤±è´¥æˆ–è¿”å› 0 ç»“æœï¼Œå…¶ä»–å¼•æ“çš„ç»“æœä»ç„¶å¯ç”¨ã€‚

### 3. **ç»“æœå¤šæ ·æ€§**
ä¸åŒå¼•æ“çš„æ’åºç®—æ³•ä¸åŒï¼Œç»„åˆç»“æœæä¾›æ›´å¤šè§†è§’ã€‚

### 4. **è‡ªåŠ¨å»é‡**
ç³»ç»Ÿè‡ªåŠ¨æ ¹æ® URL å»é‡ï¼Œç¡®ä¿ç»“æœå”¯ä¸€æ€§ã€‚

## æ¨èé…ç½®

### é…ç½® 1ï¼šæˆæœ¬ä¼˜åŒ–ï¼ˆæ¨èï¼‰
```yaml
provider: serpapi,gcp_vertex_search
```
**è¯´æ˜**ï¼š
- SerpAPI æä¾›ä¸°å¯Œçš„ç»“æ„åŒ–æ•°æ®
- GCP Vertex è¡¥å……æ›´å¤šç½‘ç»œæœç´¢ç»“æœ
- é¿å… Google Custom Search çš„ä¸¥æ ¼é™åˆ¶ï¼ˆ100æ¬¡/å¤©ï¼‰

### é…ç½® 2ï¼šæœ€å¤§è¦†ç›–
```yaml
provider: serpapi,google_custom_search,gcp_vertex_search
```
**è¯´æ˜**ï¼š
- ä½¿ç”¨æ‰€æœ‰ä¸‰ä¸ªæœç´¢å¼•æ“
- æœ€å…¨é¢çš„æœç´¢è¦†ç›–
- æ³¨æ„ Google Custom Search çš„é…é¢é™åˆ¶

### é…ç½® 3ï¼šå•ä¸€é«˜è´¨é‡
```yaml
provider: gcp_vertex_search
```
**è¯´æ˜**ï¼š
- åªä½¿ç”¨ GCP Vertex AI Search
- é€‚åˆå·²æœ‰è‡ªå®šä¹‰ç´¢å¼•çš„åœºæ™¯
- æˆæœ¬å¯æ§ï¼Œç»“æœè´¨é‡é«˜

## æ€§èƒ½è€ƒè™‘

### å¹¶å‘æ§åˆ¶

å¤šä¸ªæœç´¢å¼•æ“ä¼šå¢åŠ æ€»è¯·æ±‚æ•°ï¼Œæ³¨æ„è°ƒæ•´å¹¶å‘å‚æ•°ï¼š

```yaml
ir_rag:
  search:
    concurrent: 2   # é™ä½å¹¶å‘ä»¥é¿å…é€Ÿç‡é™åˆ¶
    qps: 1          # æ¯ç§’æŸ¥è¯¢æ•°
    retries: 2      # é‡è¯•æ¬¡æ•°
```

### å»ºè®®è®¾ç½®

| æä¾›å•†æ•°é‡ | concurrent | qps | è¯´æ˜ |
|-----------|-----------|-----|------|
| 1ä¸ª | 8 | 5 | å•ä¸€å¼•æ“ï¼Œå¯ä»¥è¾ƒé«˜å¹¶å‘ |
| 2ä¸ª | 2-4 | 1-2 | é¿å…è§¦å‘é€Ÿç‡é™åˆ¶ |
| 3ä¸ª | 2 | 1 | ä¿å®ˆè®¾ç½®ï¼Œç¡®ä¿ç¨³å®šæ€§ |

## æ—¥å¿—è¾“å‡ºç¤ºä¾‹

### å•ä¸€æœç´¢å¼•æ“
```
[IR_RAG][INIT] Using GCP Vertex AI Search
ğŸ” IR_RAG: Searching with GCP Vertex AI Search...
ğŸ” IR_RAG: Generated 5 search queries
[GCPVertexSearch] Returned 20 results (Ã—5)
ğŸ” IR_RAG: Retrieved 74 unique results from 5 queries
```

### å¤šæœç´¢å¼•æ“
```
[IR_RAG][INIT] Using multiple search providers: SerpAPI, GCP Vertex AI Search
ğŸ” IR_RAG: Searching with multiple providers: SerpAPI, GCP Vertex AI Search...
ğŸ” IR_RAG: Generated 5 search queries for each provider

ğŸ” IR_RAG: Searching with serpapi...
[SerpAPI] Returned 20 results (Ã—5)
ğŸ” IR_RAG: serpapi returned 100 results

ğŸ” IR_RAG: Searching with gcp_vertex_search...
[GCPVertexSearch] Returned 20 results (Ã—5)
ğŸ” IR_RAG: gcp_vertex_search returned 100 results

ğŸ” IR_RAG: Multi-provider search stats: {'serpapi': 100, 'gcp_vertex_search': 100}
ğŸ” IR_RAG: Total results: 200, Unique results: 150
```

## ç¯å¢ƒå˜é‡

ç¡®ä¿ä¸ºæ‰€æœ‰ä½¿ç”¨çš„æœç´¢å¼•æ“è®¾ç½®ç›¸åº”çš„ç¯å¢ƒå˜é‡ï¼š

```bash
# SerpAPI
export SERPAPI_KEY=your-serpapi-key

# Google Custom Search
export GOOGLE_SEARCH_KEY=your-google-api-key
export GOOGLE_CSE_ID=your-cse-id

# GCP Vertex AI Search
export GCP_PROJECT_ID=your-project-id
export GCP_ENGINE_ID=your-engine-id
export GCP_API_KEY=your-api-key
```

## æ•…éšœæ’æŸ¥

### é—®é¢˜ 1ï¼šæŸä¸ªå¼•æ“è¿”å› 0 ç»“æœ

**ç°è±¡**ï¼š
```
ğŸ” IR_RAG: serpapi returned 0 results
ğŸ” IR_RAG: gcp_vertex_search returned 100 results
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥è¯¥å¼•æ“çš„ API Key å’Œé…ç½®
- ç³»ç»Ÿä¼šç»§ç»­ä½¿ç”¨å…¶ä»–å¼•æ“çš„ç»“æœ
- å¯ä»¥æš‚æ—¶ä» config ä¸­ç§»é™¤å¤±è´¥çš„å¼•æ“

### é—®é¢˜ 2ï¼šé€Ÿç‡é™åˆ¶é”™è¯¯

**ç°è±¡**ï¼š
```
[GoogleSearch][ERROR] API Error (429): Too Many Requests
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
```yaml
ir_rag:
  search:
    concurrent: 1  # é™ä½å¹¶å‘
    qps: 0.5       # é™ä½ QPSï¼ˆæ¯2ç§’1ä¸ªè¯·æ±‚ï¼‰
```

### é—®é¢˜ 3ï¼šç»“æœé‡å¤è¿‡å¤š

**ç°è±¡**ï¼š
```
ğŸ” IR_RAG: Total results: 200, Unique results: 80
```

**è¯´æ˜**ï¼š
- è¿™æ˜¯æ­£å¸¸çš„ï¼Œä¸åŒå¼•æ“å¯èƒ½è¿”å›ç›¸åŒçš„ URL
- ç³»ç»Ÿä¼šè‡ªåŠ¨å»é‡
- é‡å¤ç‡é«˜è¯´æ˜æœç´¢å¼•æ“è¦†ç›–çš„å†…å®¹ç›¸ä¼¼

## æœ€ä½³å®è·µ

### âœ… æ¨èåšæ³•

1. **ä»å•ä¸€å¼•æ“å¼€å§‹**
   - å…ˆæµ‹è¯•å•ä¸ªå¼•æ“æ˜¯å¦æ­£å¸¸å·¥ä½œ
   - ç¡®è®¤ API Key å’Œé…ç½®æ­£ç¡®

2. **é€æ­¥æ·»åŠ å¼•æ“**
   - ç¡®è®¤ç¬¬ä¸€ä¸ªå¼•æ“ç¨³å®šåå†æ·»åŠ ç¬¬äºŒä¸ª
   - è§‚å¯Ÿæ—¥å¿—è¾“å‡ºéªŒè¯ç»“æœ

3. **è°ƒæ•´å¹¶å‘å‚æ•°**
   - æ ¹æ®å®é™…é€Ÿç‡é™åˆ¶è°ƒæ•´ `concurrent` å’Œ `qps`
   - é¿å…è§¦å‘ API é…é¢é™åˆ¶

4. **ç›‘æ§æˆæœ¬**
   - å¤šä¸ªå¼•æ“ä¼šå¢åŠ æ€»è¯·æ±‚æ•°å’Œæˆæœ¬
   - å®šæœŸæ£€æŸ¥ API ä½¿ç”¨é‡

### âŒ é¿å…åšæ³•

1. **ä¸è¦ç›²ç›®ä½¿ç”¨å…¨éƒ¨å¼•æ“**
   - å¦‚æœé¢„ç®—æœ‰é™ï¼Œé€‰æ‹©1-2ä¸ªé«˜è´¨é‡å¼•æ“
   - Google Custom Search çš„å…è´¹é…é¢å¾ˆæœ‰é™ï¼ˆ100æ¬¡/å¤©ï¼‰

2. **ä¸è¦è®¾ç½®è¿‡é«˜å¹¶å‘**
   - å®¹æ˜“è§¦å‘é€Ÿç‡é™åˆ¶
   - å¯èƒ½å¯¼è‡´è¯·æ±‚å¤±è´¥

3. **ä¸è¦å¿½ç•¥æ—¥å¿—è­¦å‘Š**
   - æ³¨æ„ `[WARN]` å’Œ `[ERROR]` ä¿¡æ¯
   - åŠæ—¶è°ƒæ•´é…ç½®

## æ€»ç»“

å¤šæœç´¢å¼•æ“é…ç½®è®© WebChaser èƒ½å¤Ÿï¼š

âœ… è·å¾—æ›´å…¨é¢çš„æœç´¢ç»“æœ  
âœ… æé«˜ç³»ç»Ÿå¯é æ€§ï¼ˆæ•…éšœè½¬ç§»ï¼‰  
âœ… ç»“åˆä¸åŒå¼•æ“çš„ä¼˜åŠ¿  
âœ… è‡ªåŠ¨å»é‡å’Œåˆå¹¶ç»“æœ  

æ ¹æ®ä½ çš„éœ€æ±‚å’Œé¢„ç®—ï¼Œé€‰æ‹©åˆé€‚çš„æœç´¢å¼•æ“ç»„åˆï¼

---

**æœ€åæ›´æ–°**: 2025-10-03

